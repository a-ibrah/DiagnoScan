{% extends "layout.html" %}
{% block content %}

<!-- Screen 1: Main Content -->
<div id="screen-1" class="screen active">
  
  <!-- Select Option -->
  <h3 class="text-center mb-3">Step 1: What Would You Like to Do?</h3>

  <div class="d-flex justify-content-center mb-4 gap-3">
    <button id="contribute-btn" class="btn btn-lg action-btn contribute-btn">Contribute to Database</button>
    <button id="predict-btn" class="btn btn-lg action-btn predict-btn">Make Prediction</button>
  </div>

  <!-- File Upload -->
  <div id="upload-section" class="mt-4" style="display: none;">
    <h3 class="text-center mb-3">Step 2: Upload Images</h3>
    <form id="upload-form" method="POST" action="{{ url_for('core_bp.index') }}" enctype="multipart/form-data">
      <div class="d-flex justify-content-center gap-5">
        <!-- Slide Upload -->
        <div class="upload-box text-center" id="slide-box">
          <p id="required-text" class="hidden">* Required for predictions</p>
          <h5>Pathology Slide</h5>
          <p>(.jpg, .jpeg, .png, .svs)</p>
          <p id="slide-status">No file uploaded</p>
          <input 
            class="form-control" 
            type="file" 
            id="slide-file" 
            name="slide_file" 
            accept=".jpg,.jpeg,.png,.svs" 
            style="display: none;" 
            required
          >
          <button 
            class="btn btn-secondary btn-sm upload-btn" 
            type="button"
            onclick="document.getElementById('slide-file').click();">
            Choose File
          </button>
        </div>

        <!-- PET Scan Upload -->
        <div class="upload-box text-center" id="pet-box">
          <h5>PET Scan</h5>
          <p>(.dicom)</p>
          <p id="pet-status">No file uploaded</p>
          <input 
            class="form-control" 
            type="file" 
            id="pet-file" 
            name="pet_file" 
            accept=".dicom"
            style="display: none;"
          >
          <button 
            class="btn btn-secondary btn-sm upload-btn" 
            type="button"
            onclick="document.getElementById('pet-file').click();">
            Choose File
          </button>
        </div>

        <!-- CT Scan Upload -->
        <div class="upload-box text-center" id="ct-box">
          <h5>CT Scan</h5>
          <p>(.dicom)</p>
          <p id="ct-status">No file uploaded</p>
          <input 
            class="form-control" 
            type="file" 
            id="ct-file" 
            name="ct_file" 
            accept=".dicom" 
            style="display: none;"
          >
          <button 
            class="btn btn-secondary btn-sm upload-btn" 
            type="button"
            onclick="document.getElementById('ct-file').click();">
            Choose File
          </button><div id="upload-section" class="mt-4" style="display: none;">
            <h3 class="text-center mb-3">Step 2: Upload Images</h3>
            <form id="upload-form" method="POST" action="{{ url_for('core_bp.index') }}" enctype="multipart/form-data">
              <!-- Container for Upload Boxes -->
              <div class="d-flex justify-content-center gap-5 flex-wrap">
                <!-- Pathology Slide Upload Box -->
                <div class="upload-box text-center" id="slide-box">
                  <p id="required-text" class="hidden">* Required for predictions</p>
                  <h5>Pathology Slide</h5>
                  <p>(.jpg, .jpeg, .png, .svs)</p>
                  <p id="slide-status">No file uploaded</p>
                  <input 
                    class="form-control" 
                    type="file" 
                    id="slide-file" 
                    name="slide_file" 
                    accept=".jpg,.jpeg,.png,.svs" 
                    style="display: none;" 
                    required
                  >
                  <button 
                    class="btn btn-secondary btn-sm upload-btn" 
                    type="button"
                    onclick="document.getElementById('slide-file').click();">
                    Choose File
                  </button>
                </div>
          
                <!-- PET Scan Upload Box -->
                <div class="upload-box text-center" id="pet-box">
                  <h5>PET Scan</h5>
                  <p>(.dicom)</p>
                  <p id="pet-status">No file uploaded</p>
                  <input 
                    class="form-control" 
                    type="file" 
                    id="pet-file" 
                    name="pet_file" 
                    accept=".dicom"
                    style="display: none;"
                  >
                  <button 
                    class="btn btn-secondary btn-sm upload-btn" 
                    type="button"
                    onclick="document.getElementById('pet-file').click();">
                    Choose File
                  </button>
                </div>
          
                <!-- CT Scan Upload Box -->
                <div class="upload-box text-center" id="ct-box">
                  <h5>CT Scan</h5>
                  <p>(.dicom)</p>
                  <p id="ct-status">No file uploaded</p>
                  <input 
                    class="form-control" 
                    type="file" 
                    id="ct-file" 
                    name="ct_file" 
                    accept=".dicom" 
                    style="display: none;"
                  >
                  <button 
                    class="btn btn-secondary btn-sm upload-btn" 
                    type="button"
                    onclick="document.getElementById('ct-file').click();">
                    Choose File
                  </button>
                </div>
              </div>
          
              <!-- Submit Button -->
              <div class="text-center mt-4">
                <button id="submit-btn" class="btn btn-primary btn-lg" type="button">
                  &rarr;
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Analyze Button -->
      <div class="text-center mt-4">
        <button id="analyze-btn" class="btn analyze-btn" type="button" disabled>
          Analyze
        </button>
      </div>
    </form>
  </div>

  <!-- Query Buttons -->
  <div class="d-flex justify-content-center gap-5">
    <div class="buttons-wrapper" style="display: none;">
      <button id="send-query-btn" class="query-btn">
        Send to Query<br> <small>(For Lab Technicians)</small>
      </button>
      
      <div class="separator">OR</div>

      <button id="label-query-btn" class="query-btn">
        Label Query<br><small>(For Physicians)</small>
      </button>
    </div>
  </div>
    
  <!-- Display an error message if an invalid file is uploaded -->
  {% if error %}
    <div class="alert alert-danger">
      {{ error }}
    </div>
  {% endif %}
</div>



{% endblock %}